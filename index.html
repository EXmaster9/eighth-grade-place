<!DOCTYPE html>
<html>
	<head>
	<link rel="icon" href="favicon.ico" type="image/icon">
  	<title>8th Grade Place</title>
    <style>
    	.grid { margin:1em auto; border-collapse:collapse }
      .grid td {
    		cursor:pointer;
    		width:10px; height:10px;
    		border:1px solid #ccc;
    		text-align:center;
    		font-family:sans-serif; font-size:13px
      }
			.grid td.clicked {
    		background-color:black;
    		font-weight:bold; color:red;
			}
    </style>
	</head>
	<body>
  	<h1>8th Grade Place</h1>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-3.2.1.js" integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script>
	<script>
	const socket=io();
    	var clicked = [];
		function clicko(el,row,col,i){
		var elm = document.getElementById(i);
      console.log("You clicked on element:",el);
    	console.log("You clicked on row:",row);
    	console.log("You clicked on col:",col);
    	console.log("You clicked on item #:",i);
    	elm.className='clicked';
    	if (clicked.includes(row + " " + col)) {var ind = clicked.indexOf(row + " " + col); elm.className=''; clicked.splice(ind,1);}else{
      var nC = row + " " + col;
    	clicked.push(nC);}
}
socket.on('clickot',function(data){
	clicko(data.e,data.r,data.c,data.ind);
	console.log("received clickot");
});

			var grid = clickableGrid(50,100,function(el,row,col,i) {
			socket.emit('clicko',{e:el,r:row,c:col,ind:i});
		});

document.body.appendChild(grid);
     
function clickableGrid( rows, cols, callback ){
    var i=0;
    var grid = document.createElement('table');
    grid.className = 'grid';
    for (var r=0;r<rows;++r){
        var tr = grid.appendChild(document.createElement('tr'));
        for (var c=0;c<cols;++c){
            var cell = tr.appendChild(document.createElement('td'));
			cell.id = ++i;
            cell.addEventListener('click',(function(el,r,c,i){
                return function(){
                    callback(el,r,c,i);
                }
            })(cell,r,c,i),false);
        }
    }
    return grid;
}
    </script>
	</body>
</html>